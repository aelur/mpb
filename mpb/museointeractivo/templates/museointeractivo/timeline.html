{% load staticfiles %}
<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>Museo de la Pasión Boquense</title>
    <LINK href="{% static 'css/timeline.css' %}" rel="stylesheet" type="text/css">
    <LINK href="{% static 'css/animate.css' %}" rel="stylesheet" type="text/css">
  </head>
<body style="background:url('{% static 'img/BG.jpg' %}')  no-repeat center center fixed">

<div id="body_timeline" >
	<div class="fondo_campeonato"></div>
	<div class="nombre">TODOS</div>
	
	<div class="TOPBAR">
		<div class="left">
			<img src="{% static 'img/logo.png' %}" class="responsive">
			<div class="typesetter">
				<div class="selector" id="copas_active"><img src="{% static 'img/todos.png' %}" id="todos"><span class="flecha">></span><span class="titulo todos">TODOS</span></div>
				<div class="selector" id="copas"><img src="{% static 'img/int.png' %}" id="int"><span class="flecha">></span><span class="titulo int">INTERNACIONALES</span></div>
				<div class="selector" id="copas"><img src="{% static 'img/nac.png' %}" id="nac"><span class="flecha">></span><span class="titulo nac">NACIONALES</span></div>
			</div>
		</div>
		<div class="right">
			<div class="typesetter">
				<div class="selector" id="lang_active"><img src="{% static 'img/es.png' %}" id="es"></div>
				<div class="selector" id="lang"><img src="{% static 'img/en.png' %}" id="en"></div>
				<div class="selector" id="lang"><img src="{% static 'img/por.png' %}" id="por"></div>
			</div>
		</div>
	</div>
	
	<div class ="BOTTOMBAR">
		<div id="prev" class="button prev"><</div>
		<div id="next" class="button next">></div>
	</div>
	<div id="carousel">
	
	</div>
</div>
</body>
<script type="text/javascript" src="{% static 'js/jquery-1.9.1.min.js' %}"></script>
<script type="text/javascript" src="{% static 'js/jquery.waterwheelCarousel.js' %}"></script>
<script type="text/javascript">
	var filtrar = function(tipo, carousel){
		var filtrados;
		var primero;
		if (tipo=='>TODOS') {
			filtrados = datos_campeonatos;
			if (typeof default_starter == 'undefined'){
				primero = filtrados[0].id;
				opciones.startingItem = 1;
			} else{
				primero = default_starter;
				$.each(filtrados,function(index,elem){
					if (elem.id==default_starter) opciones.startingItem = index + 1;
				});
			};
		}else{
			if (tipo == '>INTERNACIONALES') tipo = 'INT';
			if (tipo == '>NACIONALES') tipo = 'NAC';
			filtrados = $.grep(datos_campeonatos, function(elem, index){
				return (elem.tipo==tipo);
			});
			primero=filtrados[0].id;
			opciones.startingItem = 1;
		};
		$("#carousel").empty();
		$.each(filtrados, function(index, elemento){
				var html_nuevo = "<div id=div_camp"+elemento.id+">"
						+"<a href='"+elemento.url+"'><img src="
						+elemento.imgcopa+" width='140px' height='140px' alt="+elemento.id+" >"
						+"<span class='anio' id='a"+elemento.id+"' >"
						+elemento.anio+"</span></a>"
						+"<em id="+elemento.id+">"+elemento.titulo+"</em></div>"
				$("#carousel").append(html_nuevo);
			});
		var elem = $.grep(filtrados, function(e,i){return (e.id==primero)})[0];
		$('em').css('opacity',0);
		$('.anio').css('opacity',0);
		$("#"+primero).css('opacity',1);
		$("#a"+primero).css('opacity',1);
		$(".fondo_campeonato").css({"background": 
							"url("+elem.urlbg+") no-repeat center center fixed"});
		if (typeof carousel != 'undefined') carousel.reload(opciones);
	} 
	$(document).ready(function() {
		var carousel = $("#carousel").waterwheelCarousel(opciones);
		
		$('#prev').bind('click', function () {
			carousel.prev();
			return false
		});
	
		$('#next').bind('click', function () {
			carousel.next();
			return false;
		});
		
		$('.selector').click(function(){
			if ($(this).attr('id') == 'copas_active' || $(this).attr('id') == 'copas' ){
				$objActivo = $("#copas_active");			
				$objActivo.find(".titulo").animate({opacity:0, 'margin-top':40});	
				$objActivo.find(".flecha").animate({opacity:0, 'margin-top':40});	
				$objActivo.attr('id','copas');
				$(this).attr('id','copas_active');
				$(this).find(".titulo").animate({opacity:0.7, 'margin-top':97});	
				$(this).find(".flecha").animate({opacity:0.7, 'margin-top':50});	
				
				$('.nombre').text($('#copas_active').find('.titulo').text());
				var tipo = $(this).find('span').text();
				filtrar(tipo, carousel);
			}else{
				$objActivo = $("#lang_active");
				$objActivo.find("img").animate({opacity:0.4});		
				$objActivo.attr('id','lang');
				$(this).attr('id','lang_active');
				$(this).find("img").animate({opacity:1});	
				var lenguaje = $(this).find("img").attr('id');
				if(lenguaje=='es'){
					$('.todos').text('TODOS');
					$('.nac').text('NACIONALES');
					$('.int').text('INTERNACIONALES');
					$('.nombre').text($('#copas_active').find('.titulo').text());
					{% for campeonato in campeonatos %}
						$('#{{campeonato.id}}').text("{{ campeonato.titulo_es }}");	
					{% endfor %}
				}
				if(lenguaje=='en'){
					$('.todos').text('ALL');
					$('.nac').text('NATIONALS');
					$('.int').text('INTERNATIONALS');
					$('.nombre').text($('#copas_active').find('.titulo').text());
					{% for campeonato in campeonatos %}
						$('#{{campeonato.id}}').text("{{ campeonato.titulo_en }}");	
					{% endfor %}
				}
				if(lenguaje=='por'){
					$('.todos').text('TODOS');
					$('.nac').text('NACIONAIS');
					$('.int').text('INTERNACIONAIS');
					$('.nombre').text($('#copas_active').find('.titulo').text());
					{% for campeonato in campeonatos %}
						$('#{{campeonato.id}}').text("{{ campeonato.titulo_por }}");	
					{% endfor %}
				}
			}
		});
	});
	var datos_campeonatos=[ 
				{% for campeonato in campeonatos %}
					{"id": {{campeonato.id}},
					"tipo": '{{campeonato.tipo}}',
					"urlbg": '{{campeonato.imagen_fondo.url}}',
					"imgcopa":"{% if campeonato.imagen_copa%}{{ campeonato.imagen_copa.url }}{% else %}{% static 'img/estrella.png' %}{% endif %}",
					"url": "{% url 'datos' campeonato.id %}",
					"titulo": "{{ campeonato.titulo_es }}",
					"anio" : "{{ campeonato.anio }}"
					},
				{% endfor %}
			]
	var default_starter = $.grep(datos_campeonatos,function(elem,index){
		return elem.anio=="2000";
	})[0].id;
	var opciones = {
			horizon: 110,
			horizonOffset: 10,
			startingItem:0,
			horizonOffsetMultiplier: .4,
			sizeMultiplier: .7,
			separationMultiplier: .8,
			separation: 150,
			edgeFadeEnabled: true,
			animationEasing: 'linear',
			linkHandling: 2,
			movingFromCenter: function($newCenterItem){	
					$objTexto = $("#" + $newCenterItem.attr('alt'));
					$objTexto.stop(true,true).animate({
            			fontSize: 9,
            			opacity: 0
        			});
					$objANIO = $("#a" + $newCenterItem.attr('alt'));
					$objANIO.stop(true,true).animate({opacity: 0});
			},
			movedToCenter: function($newCenterItem){
				$objTexto = $("#" + $newCenterItem.attr('alt'));
				$objTexto.stop(true,true).animate({
            		fontSize: 18,
            		opacity: .9
        		});
				$objANIO = $("#a" + $newCenterItem.attr('alt'));
				$objANIO.stop(true,true).animate({opacity: 1});
				var tipo = $.grep(datos_campeonatos, function(elem,index){
					return elem.id ==  $newCenterItem.attr('alt');
				})[0].tipo;
				if(tipo=='INT') $objANIO.css({'transform': 'translate(-50%,570%)'});

				$(".fondo_campeonato").css("background", 
							"url("+datos_campeonatos[$newCenterItem.attr('alt')-1].urlbg+") no-repeat center center fixed");
			}
		};
	filtrar('>TODOS');
</script>
</html>